# Configuration file for concept bottleneck model experiments

experiment_name: "bird_classification"  # Name of the experiment for logging purposes

dataset:
  name: "CUB"  # Name of the dataset (currently supports "CUB" for Caltech-UCSD Birds)
  path: "data/CUB_200_2011"  # Path to the dataset directory
  batch_size: 64  # Number of samples per batch for training and testing
  majority_voting: True  # Whether to use majority voting for concept labels
  concept_threshold: 10

training:
  batch_size: 64
  epochs: 1000  # Number of training epochs
  save_step: 100 # Number of epochs between model saves
  lr: 0.001  # Initial learning rate for optimization
  momentum: 0.9  # Momentum factor for SGD optimizer
  weight_decay: 5e-5  # Weight decay (L2 penalty) for optimization
  lambda1: 0.1  # Weighting factor for concept loss in joint training
  scheduler_step: 1000  # Number of steps before decaying current learning rate by half

models:
  concept_model: "inception"  # Type of model for concept prediction (e.g., "inception", "resnet")
  pretrained: True  # Whether to use pretrained weights for the concept model
  freeze: false  # Whether to freeze the bottom part of the inception network
  use_aux: false  # Whether to use auxiliary logits
  use_attr: false  # Whether to use attributes (for cotraining architecture only)
  no_img: false  # If true, only use attributes (not raw images) for class prediction
  bottleneck: false  # Whether to predict attributes before class labels
  n_attributes: 312  # Number of attributes to apply bottlenecks to (assuming N_ATTRIBUTES is 312)
  expand_dim: 0  # Dimension of hidden layer for increased model capacity (for bottleneck only)
  n_class_attr: 2  # Whether attribute prediction is binary (2) or trinary classification


mode: "standard"  #"standard", "independent", "joint", "sequential"]  # List of training modes to iterate over

device: "auto"  # Device to use for training ("auto" for automatic detection, "cuda" for GPU, "cpu" for CPU)